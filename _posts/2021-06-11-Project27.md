---
title: "API GW 상용화 서비스 개발 (API GW편)"
---

# 개요

어느날 개발 요청이 들어왔다

- API GW
- Agent

Agent가 DB Data를 읽어 API GW로 발송 하는 구조로 구조 자체는 단순 하지만 구현해야 하는 기능이 많았다.</br>

---

# 방향성

개발에 방향성을 아래와 같이 잡았다.

1. 확장이 가능한 구조
1. 기능 추가가 자유로운 구조
1. 장애 최소화
1. 레거시를 만들지 말자

관련하여 개발을 리소스를 줄이기 위하여 AWS 기능을 최대한 사용 하기로 하였다.

---

# 구성도

![구성도](https://github.com/Tosi123/Tosi123.github.io/blob/master/assets/image/gw_diagrams.png?raw=true)

개발을 진행 하면서 구성도는 계속 바뀔꺼 같다.

---

# 기능

1. API 사용자 인증
   - 구현이 쉽게 KEY 방식을 사용하고 싶지만 보안상 Pass..
   - AWS Cognito를 이용한 구현
   - Token 방식 직접 구현 Redis 사용 필요
   - Token을 발행한 IP와 사용하는 IP 동일 체크 기능
1. Agent Request 제한
   - API를 호출 할때마다 실제로 데이터가 발송 되므로 고객별 호출 횟수 제한
   - Redis 사용 예정
1. 라우팅 기능
   - 고객별 호출되는 백앤드를 다르게 하기 위하여 라우팅 도입
   - Redis 사용 예정
1. 기능 추가가 쉬워야 한다
   - API URL 버저닝을 통하여 분리
   - api.test.com/v1.0/test
1. 연동 테스트 API 지원
   - 고객이 연동 개발을 할때 운영용이 아닌 테스트용으로 사용 가능 할 수 있도록 분리
   - URL 분리와 라우팅 기능 활용
1. 로드벨런싱
   - AWS ELB 이용
1. 메시지 큐 도입
   - Lamabda가 DB 연결을 하게 하지 못하게 하기위해 큐 도입

---

# 느낀점

아직 개발을 진행중 이지만 AWS를 이용하니 개발에 필요한 리소스를 획기적으로 줄일수 있어 신세계 였다...
너무 좋다...
